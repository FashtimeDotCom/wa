{% extends "layouts/admin_base.html" %}

{% from "macros/_misc.html" import render_flash_message %}
{% block body %}
{% block css_style %}
<link rel="stylesheet" href="{{ url_for('static', filename='editor/themes/default/default.css') }}">
{% endblock %}
<div class="container">
	<div id="tab_li">
    	<ul>
            <li><a href="{{ url_for('admin.image_manager') }}">幻灯片管理</a></li>
            <a href="{{ url_for('admin.widget_index') }}"><li class="active">小组件管理</li></a>
        </ul>
    </div>
    <div class="control-group">
        <div class="controls"></div>
    </div>
    <div class="table_tit">编辑小组件</div>
    <div id="list_zoom">
    	<div class="table_con active">
        <form method="POST" class="form-horizontal">
        {{ form.csrf_token }}
            <div class="control-group">
                <label class="control-label" for="title">标题</label>
                <div class="controls">
                    <input name="title" type="text" value="{{ widget.title }}">
                    {% if form.title.errors %}
                	<span style="color:red;">{{ form.title.errors|join(', ') }}</span>
                	{% endif %}
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="position">位置</label>
                <div class="controls">
                    <select name="position">
                    	<option value="1"{% if widget.position == 1 %} selected='selected' {% endif %}> 1 </option>
                    	<option value="2"{% if widget.position == 2 %} selected='selected' {% endif %}> 2 </option>
                    	<option value="3"{% if widget.position == 3 %} selected='selected' {% endif %}> 3 </option>
                    </select>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="is_hidden">是否隐藏
                </label>
                <div class="controls">
                    {{ form.is_hidden }}
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="content">内容</label>
                <div class="controls">
                    <textarea name="content" style="width: 750px; height: 600px;">{{ widget.content }}</textarea>
                    {% if form.content.errors %}
                	<span style="color:red;">{{ form.content.errors|join(', ') }}</span>
                	{% endif %}
                </div>
            </div>
            <div class="form-button">
                <button type="submit">提交</button>
            </div>
        </form>
        </div>
    </div>
</div>

{% block footerjs %}
<script type="text/javascript" src="{{ url_for('static', filename='editor/kindeditor.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/ajaxupload.js') }}"></script>
<script type="text/javascript">
var editor;
KindEditor.ready(function(K) {
    editor = K.create('textarea', {
        uploadJson: "{{ url_for('admin.upload') }}",
        extraFileUploadParams: {
            "folder": "uploads"
        },
        formatUploadUrl: false,
        allowPreviewEmoticons : false,
        allowImageUpload : true,
        themeType : 'simple',
        'filePostName': 'image',
        items : [
            'fontname', 'fontsize', '|', 'undo', 'redo', '|', 'forecolor', 'hilitecolor', 'bold', 'italic', 'underline',
            'removeformat', '|', 'justifyleft', 'justifycenter', 'justifyright', 'insertorderedlist',
            'insertunorderedlist', '|', 'emoticons', 'image', 'link','|', 'preview', 'print', '|', 'source', '|',
            'fullscreen', '|']
    });
});
</script>
{% endblock %}

{% endblock %}